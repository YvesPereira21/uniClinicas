# UniClinicas

Este projeto √© uma API REST para gerenciamento de cl√≠nicas, m√©dicos, usu√°rios e agendamentos.

## üóÇÔ∏è Estrutura de Pastas

-   `src/main/java`: Cont√©m todo o c√≥digo-fonte da aplica√ß√£o.
    -   `com/projeto/uniClinicas`: Pacote raiz do projeto.
        -   `authentication`: Cont√©m DTOs para autentica√ß√£o.
        -   `controller`: Respons√°vel por expor a API REST, recebendo as requisi√ß√µes HTTP.
        -   `dto`: Utilizados para transferir dados entre as camadas da aplica√ß√£o e cont√©m outros DTOs em uma pasta dentro para auxiliar na cria√ß√£o de objetos.
        -   `enums`: Cont√©m as enumera√ß√µes, como `UserRole`.
        -   `exception`: Classes de exce√ß√µes customizadas.
        -   `mapper`: Classes de mapeamento de DTOs para entidades e vice-versa.
        -   `model`: Classes de entidade que representam as tabelas do banco de dados.
        -   `repository`: Interfaces para opera√ß√µes de acesso a dados.
        -   `security`: Configura√ß√µes de seguran√ßa da aplica√ß√£o, incluindo filtros e servi√ßos de token.
        -   `seeds`: Classe para popular o banco de dados com dados iniciais.
        -   `service`: Cont√©m a l√≥gica de neg√≥cio da aplica√ß√£o.
        -   `validation`: Classes para valida√ß√µes customizadas.
-   `src/main/resources`: Arquivos de configura√ß√£o e recursos.
    -   `application.properties`: Arquivo de configura√ß√£o principal do Spring Boot.
-   `src/test/java`: Cont√©m os testes da aplica√ß√£o.
-   `pom.xml`: Arquivo de configura√ß√£o do Maven, com as depend√™ncias e configura√ß√µes do projeto.

## Roles

O sistema possui tr√™s tipos de `roles` (perfis de usu√°rio) com diferentes n√≠veis de acesso:

-   **ADMIN**: Administrador do sistema, com acesso total a todas as funcionalidades.
-   **CLINICA**: Perfil destinado a cl√≠nicas, com permiss√µes para gerenciar seus pr√≥prios dados, m√©dicos e agendamentos.
-   **USER**: Usu√°rio padr√£o, com permiss√µes para consultar informa√ß√µes, fazer avalia√ß√µes e interagir com as cl√≠nicas.

## Seeds

Ao iniciar a aplica√ß√£o, os seguintes usu√°rios s√£o criados no banco de dados para fins de teste e demonstra√ß√£o:

### Admin

-   **username**: `admin`
-   **password**: `admin123`
-   **role**: `ADMIN`

### Cl√≠nica

-   **username**: `clinica_unip`
-   **password**: `clinica123`
-   **role**: `CLINICA`

-   **username**: `SouDoto`
-   **password**: `soudoto123`
-   **role**: `CLINICA`

## Rotas da API

A seguir est√£o listadas as rotas da API, organizadas por m√©todo HTTP e com as permiss√µes de acesso para cada `role`.

### POST

| Rota                                           | Descri√ß√£o                                         | Roles Permitidas |
| ---------------------------------------------- | ------------------------------------------------- | ---------------- |
| `/auth/login`                                  | Realiza o login do usu√°rio.                       | `permitAll`      |
| `/auth/register`                               | Registra um novo usu√°rio (USER).                  | `permitAll`      |
| `/api/clinicas`                                | Adiciona uma nova cl√≠nica.                        | `ADMIN`          |
| `/api/medicos`                                 | Adiciona um novo m√©dico.                          | `CLINICA`        |
| `/api/clinicas/{clinicaId}/agendas`            | Adiciona uma nova agenda para uma cl√≠nica.        | `CLINICA`        |
| `/api/clinicas/{clinicaId}/avaliacoes`         | Cria uma avalia√ß√£o para uma cl√≠nica.              | `USER`           |
| `/api/enderecos`                               | Encontra uma cl√≠nica pelo endere√ßo.               | `ADMIN`, `USER`  |

### PUT

| Rota                                 | Descri√ß√£o                                 | Roles Permitidas |
| ------------------------------------ | ----------------------------------------- | ---------------- |
| `/api/clinicas/{clinicaId}`          | Atualiza uma cl√≠nica existente.           | `ADMIN`          |
| `/api/clinicas/{clinicaId}/enderecos` | Atualiza o endere√ßo de uma cl√≠nica.       | `CLINICA`        |
| `/api/medicos/{medicoId}`            | Atualiza um m√©dico existente.             | `CLINICA`        |
| `/api/usuarios/{usuarioId}`          | Atualiza os dados de um usu√°rio.          | `USER`           |
| `/api/clinicas/{clinicaId}/agendas`  | Atualiza a agenda de uma cl√≠nica.         | `CLINICA`        |

### GET

| Rota                                                           | Descri√ß√£o                                          | Roles Permitidas        |
| -------------------------------------------------------------- | -------------------------------------------------- | ----------------------- |
| `/api/clinicas/{clinicaId}`                                    | Retorna uma cl√≠nica espec√≠fica.                    | `ADMIN`, `CLINICA`, `USER` |
| `/api/clinicas`                                                | Lista cl√≠nicas por nome.                           | `ADMIN`, `USER`         |
| `/api/enderecos/{nomeMunicipio}/clinicas`                      | Lista as cl√≠nicas de um munic√≠pio.                 | `ADMIN`, `USER`         |
| `/api/medicos/{medicoId}`                                      | Busca um m√©dico espec√≠fico.                        | `CLINICA`, `USER`       |
| `/api/agendas`                                                 | Lista a agenda de uma cl√≠nica.                     | `USER`                  |
| `/api/medicos/{medicoId}/clinicas/{clinicaId}/agendas`         | Lista a agenda de um m√©dico em uma cl√≠nica.        | `ADMIN`, `USER`         |
| `/api/usuarios/{usuarioId}/avaliacoes`                         | Lista todas as avalia√ß√µes de um usu√°rio.           | `ADMIN`                 |
| `/api/clinicas/{clinicaId}/avaliacoes`                         | Lista todas as avalia√ß√µes de uma cl√≠nica.          | `USER`                  |
| `/api/clinicas/{clinicaId}/avaliacoes-media`                   | Calcula a avalia√ß√£o m√©dia de uma cl√≠nica.          | `USER`, `CLINICA`       |

### DELETE

| Rota                           | Descri√ß√£o                    | Roles Permitidas |
| ------------------------------ | ---------------------------- | ---------------- |
| `/api/clinicas/{clinicaId}`    | Remove uma cl√≠nica.          | `ADMIN`          |
| `/api/medicos/{medicoId}`      | Deleta um m√©dico.            | `CLINICA`        |
| `/api/agendas/{agendaId}`      | Remove uma agenda cl√≠nica.   | `CLINICA`        |
| `/api/avaliacoes/{avaliacaoId}` | Deleta uma avalia√ß√£o.        | `USER`, `ADMIN`  |
| `/api/usuarios/{usuarioId}`    | Deleta um usu√°rio.           | `ADMIN`  |
