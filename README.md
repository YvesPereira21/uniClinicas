# UniClinicas

Este projeto √© uma API REST para gerenciamento de cl√≠nicas, m√©dicos, usu√°rios e agendamentos. No come√ßo s√£o os detalhamentos da estrutura das rotas e p√°peis, al√©m das seeds com alguns p√°peis. No final, √© mostrado como executar o projeto.

## üóÇÔ∏è Estrutura de Pastas

O projeto segue a estrutura padr√£o do Spring Boot:

-   `src/main/java`: Cont√©m todo o c√≥digo-fonte da aplica√ß√£o.
    -   `com/projeto/uniClinicas`: Pacote raiz do projeto.
        -   `authentication`: Cont√©m DTOs para autentica√ß√£o.
        -   `controller`: Respons√°vel por expor a API REST, recebendo as requisi√ß√µes HTTP.
        -   `dto`: Utilizados para transferir dados entre as camadas da aplica√ß√£o, al√©m de possuir outra pasta dentro com DTOs para facilita√ß√£o de cria√ß√£o de objetos.
        -   `enums`: Cont√©m as enumera√ß√µes, como `UserRole`.
        -   `exception`: Classes de exce√ß√µes customizadas.
        -   `mapper`: Classes para mapear DTOs para entidades e vice-versa.
        -   `model`: Classes de entidade.
        -   `repository`: Interfaces de opera√ß√µes de acesso a dados.
        -   `security`: Configura√ß√µes de seguran√ßa da aplica√ß√£o, incluindo filtros e token.
        -   `seeds`: Classe para popular o banco de dados com dados iniciais.
        -   `service`: L√≥gica de neg√≥cio da aplica√ß√£o.
        -   `validation`: Classes para valida√ß√µes customizadas.
-   `src/main/resources`: Arquivos de configura√ß√£o e recursos.
    -   `application.properties`: Arquivo de configura√ß√£o principal do Spring Boot.
-   `src/test/java`: Cont√©m os testes da aplica√ß√£o.
-   `pom.xml`: Arquivo de configura√ß√£o do Maven, com as depend√™ncias e configura√ß√µes do projeto.

## Roles

O sistema possui tr√™s tipos de `roles` (perfis de usu√°rio) com diferentes n√≠veis de acesso:

-   **ADMIN**: Administrador do sistema, com acesso total a todas as funcionalidades.
-   **CLINICA**: Perfil destinado a cl√≠nicas, com permiss√µes para gerenciar seus pr√≥prios dados, m√©dicos e agendamentos.
-   **USER**: Usu√°rio padr√£o, com permiss√µes para consultar informa√ß√µes, fazer avalia√ß√µes e interagir com as cl√≠nicas.


## Seeds

Ao iniciar a aplica√ß√£o, os seguintes usu√°rios s√£o criados no banco de dados para fins de teste e demonstra√ß√£o:

### Admin

-   **username**: `admin`
-   **password**: `admin123`
-   **role**: `ADMIN`

### Cl√≠nica

-   **username**: `clinica_unip`
-   **password**: `clinica123`
-   **role**: `CLINICA`

-   **username**: `SouDoto`
-   **password**: `soudoto123`
-   **role**: `CLINICA`

## Rotas da API

A seguir est√£o listadas as rotas da API, organizadas por m√©todo HTTP e com as permiss√µes de acesso para cada `role` atualizadas.

### POST

| Rota | Descri√ß√£o | Roles Permitidas |
| --- | --- | --- |
| `/auth/login` | Realiza o login do usu√°rio. | `permitAll` |
| `/auth/register` | Registra um novo usu√°rio (USER). | `permitAll` |
| `/auth/change-password` | Permite que um usu√°rio altere sua senha. | `permitAll` |
| `/api/clinicas` | Adiciona uma nova cl√≠nica. | `CLINICA` |
| `/api/medicos` | Adiciona um novo m√©dico. | `CLINICA` |
| `/api/clinicas/{clinicaId}/agendas` | Adiciona uma nova agenda para uma cl√≠nica. | `CLINICA` |
| `/api/clinicas/{clinicaId}/avaliacoes` | Cria uma avalia√ß√£o para uma cl√≠nica. | `USER` |
| `/api/enderecos` | Encontra uma cl√≠nica pelo endere√ßo. | `ADMIN`, `USER` |

### PUT

| Rota | Descri√ß√£o | Roles Permitidas |
| --- | --- | --- |
| `/api/clinicas/{clinicaId}` | Atualiza uma cl√≠nica existente. | `ADMIN` |
| `/api/clinicas/{clinicaId}/enderecos` | Atualiza o endere√ßo de uma cl√≠nica. | `CLINICA` |
| `/api/medicos/{medicoId}` | Atualiza um m√©dico existente. | `CLINICA` |
| `/api/usuarios/{usuarioId}` | Atualiza os dados de um usu√°rio. | `USER` |
| `/api/clinicas/{clinicaId}/agendas` | Atualiza a agenda de uma cl√≠nica. | `CLINICA` |

### GET

| Rota | Descri√ß√£o | Roles Permitidas |
| --- | --- | --- |
| `/api/clinicas/{clinicaId}` | Retorna uma cl√≠nica espec√≠fica. | `ADMIN`, `CLINICA`, `USER` |
| `/api/clinicas` | Lista cl√≠nicas por nome. | `ADMIN`, `USER` |
| `/api/enderecos/{nomeMunicipio}/clinicas` | Lista as cl√≠nicas de um munic√≠pio. | `ADMIN`, `USER` |
| `/api/medicos/{medicoId}` | Busca um m√©dico espec√≠fico. | `CLINICA`, `USER` |
| `/api/agendas` | Lista a agenda de uma cl√≠nica. | `USER` |
| `/api/medicos/{medicoId}/clinicas/{clinicaId}/agendas` | Lista a agenda de um m√©dico em uma cl√≠nica. | `ADMIN`, `USER` |
| `/api/usuarios/{usuarioId}/avaliacoes` | Lista todas as avalia√ß√µes de um usu√°rio. | `ADMIN` |
| `/api/clinicas/{clinicaId}/avaliacoes` | Lista todas as avalia√ß√µes de uma cl√≠nica. | `USER` |
| `/api/clinicas/{clinicaId}/avaliacoes-media` | Calcula a avalia√ß√£o m√©dia de uma cl√≠nica. | `USER`, `CLINICA` |

### DELETE

| Rota | Descri√ß√£o | Roles Permitidas |
| --- | --- | --- |
| `/api/clinicas/{clinicaId}` | Remove uma cl√≠nica. | `ADMIN` |
| `/api/medicos/{medicoId}` | Deleta um m√©dico. | `CLINICA` |
| `/api/agendas/{agendaId}` | Remove uma agenda cl√≠nica. | `CLINICA` |
| `/api/avaliacoes/{avaliacaoId}` | Deleta uma avalia√ß√£o. | `USER`, `ADMIN` |
| `/api/usuarios/{usuarioId}` | Deleta um usu√°rio. | `ADMIN` |


## Siga os passos abaixo para clonar e executar a aplica√ß√£o.

### 1. Clonar o Reposit√≥rio

Utilize o comando abaixo no terminal para clonar o projeto:

git clone <URL_DO_SEU_REPOSIT√ìRIO>
cd uniClinicas


### 2. Iniciar o servidor pela IDE


### 3. Acessar os Recursos

Uma vez que o servidor estiver em execu√ß√£o na porta padr√£o (`8080`), voc√™ pode acessar a documenta√ß√£o e o banco de dados conforme a tabela abaixo:

| Recurso | URL | Observa√ß√£o |
| :--- | :--- | :--- |
| **Documenta√ß√£o da API (Swagger UI)** | `http://localhost:8080/swagger-ui/index.html#/` | Use esta interface para explorar e testar todas as rotas da API, al√©m de gerar tokens de autentica√ß√£o. |
| **Console do Banco de Dados H2** | `http://localhost:8080/h2-ui` | Este √© um banco de dados **em mem√≥ria**. Os dados s√£o perdidos ao reiniciar o servidor por estar configurado como "ddl-auto:create-drop". Use as credenciais padr√£o para login: **Username: `sa`** e **Password: (vazio)**. |
